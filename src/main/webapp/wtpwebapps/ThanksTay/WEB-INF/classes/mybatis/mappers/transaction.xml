<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="com.tt.Host.HostAnalysisDao">
	<insert id="insertBank" parameterType="com.tt.vo.TransactionRegisterVO">
		insert into Thxtay_transaction_register
		(tr_no, user_no, tr_name, tr_email, tr_birth, tr_phone, tr_currency, tr_payment, tr_bank_code, tr_account)
		values
		(tr_seq.nextval, #{userNo}, #{name}, #{email}, #{birth}, #{phone}, #{currency}, #{payment}, #{bankCode}, #{account} )
	</insert>
	
	<select id="getAllTransactionHistoryForExcel" parameterType="int" resultType="com.tt.vo.TransactionHistoryDTO">
		select  
				R.tr_account bankAccount,
				L.lodging_name lodgingName,
				Pm.booking_no bookingNo, 
				H.transaction_no transactionNo, 
				H.lodging_no lodgingNo, 
			   	H.transaction_created_date createdDate, 
			   	Pr.price_lodging_fee lodgingFee, 
			   	Pr.price_cleaning_fee cleaningFee
		from 
			Thxtay_transaction_register R, Thxtay_transaction_history H, Thxtay_lodging L, Thxtay_payment Pm, Thxtay_price Pr, Thxtay_user U
		where 
			H.lodging_no = L.lodging_no 
			and H.payment_no = Pm.payment_no
			and H.price_no = Pr.price_no
			and R.tr_no = H.tr_no
			and U.user_no = #{userNo}
	</select>

	<select id="getAllTransactionHistoryByHashMap" parameterType="map" resultType="com.tt.vo.TransactionHistoryDTO">
		select  
				R.tr_account bankAccount,
				L.lodging_name lodgingName,
				Pm.booking_no bookingNo, 
				H.transaction_no transactionNo, 
				H.lodging_no lodgingNo, 
			   	H.transaction_created_date createdDate, 
			   	Pr.price_lodging_fee lodgingFee, 
			   	Pr.price_cleaning_fee cleaningFee
		from 
			Thxtay_transaction_register R, Thxtay_transaction_history H, Thxtay_lodging L, Thxtay_payment Pm, Thxtay_price Pr, Thxtay_user U
		where 
			H.lodging_no = L.lodging_no 
			and H.payment_no = Pm.payment_no
			and H.price_no = Pr.price_no
			and H.tr_no = R.tr_no
			and U.user_no = #{userNo}
	</select>

	<select id="getCommonCodeByPntCode" parameterType="string" resultType="com.tt.vo.CommonCodeVO">
		select commoncode, codecontent
		from thxtay_common_code
		where parentcode like #{value}
	</select>
</mapper>