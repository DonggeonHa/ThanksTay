<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.tt.Admin.AdminDao">

	<resultMap id="userMap" type="java.util.HashMap">
		<result column="RNUM" property="rnum"/>
		<result column="USER_NO" property="no"/>
		<result column="USER_EMAIL" property="email"/>
		<result column="USER_NAME" property="name"/>
		<result column="USER_BIRTH" property="birth"/>
		<result column="USER_PHONE" property="phone"/>
		<result column="USER_EMAIL_CHECK" property="emailCheck"/>
	</resultMap>

	<select id="getUsers" resultMap="userMap">
		SELECT
		        RNUM,
		        USER_NO 					as no,
				USER_EMAIL 					as email,
				USER_NAME 					as name,
		TO_CHAR(USER_BIRTH, 'YYYY-MM-DD') 	as birth,
				USER_PHONE 					as phone,
				USER_EMAIL_CHECK 			as emailCheck
		FROM (SELECT
					 ROW_NUMBER() OVER (ORDER BY USER_EMAIL_CHECK DESC , USER_NO ASC) as RNUM,
					 USER_NO, USER_EMAIL, USER_NAME, USER_BIRTH, USER_PHONE, USER_EMAIL_CHECK
			  FROM
			  		 (SELECT
			  		 		 *
			  	   	  FROM
			  	   	  		 THXTAY_USER))
 	</select>

	<select id="getUserByNo" parameterType="int" resultType="com.tt.User.UserVO">
		SELECT
		        USER_NO 							as no,
				USER_NAME 							as name,
		TO_CHAR(USER_BIRTH, 'YYYY-MM-DD') 			as birth,
				USER_EMAIL 							as email,
				USER_INFO							as info,
				USER_ISHOST							as isHost,
				USER_ISADMIN						as isAdmin,
				USER_DELETED						as deleted,
		TO_DATE(USER_CREATED_DATE, 'YYYY-MM-DD')	as createdDate,
		TO_DATE(USER_UPDATED_DATE, 'YYYY-MM-DD')	as updatedDate,
				USER_PICTURE						as picture,
				USER_PHONE 							as phone,
				USER_EMAIL_CHECK 					as emailCheck
		FROM
				THXTAY_USER
		WHERE
				USER_NO = #{value}
	</select>
</mapper>